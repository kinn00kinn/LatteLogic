/*
 * Obsidian Theme: Step-Down Professional
 * * Design Philosophy:
 * 1. Sharp Aesthetic: No rounded corners on headers (User Request).
 * 2. High Readability: Enhanced Source Mode & Tables.
 * 3. Consistent Lists: Bullets match text color.
 * 4. User Accent: Uses Obsidian's native Accent Color setting.
 */

/* ==========================================================================
   1. Theme Variables (Backgrounds & Basics)
   ========================================================================== */
.theme-dark {
	--background-primary: #24273a;
	--background-primary-alt: #1e2030;
	--background-secondary: #181926;
	--background-secondary-alt: #181926;
	--background-modifier-border: #363a4f;
	--background-modifier-hover: rgba(202, 211, 245, 0.1);
	--background-modifier-active-hover: rgba(202, 211, 245, 0.15);

	--text-normal: #cad3f5;
	--text-muted: #939ab7;
	--text-faint: #5b6078;

	--code-background: #1e2030;
	--code-normal: #cad3f5;

	/* Custom features colors */
	--table-header-bg: #363a4f;
	--table-row-alt-bg: #2a2d3e;
	--tag-bg: #363a4f;
	--active-line-bg: rgba(138, 173, 244, 0.08); /* Faint accent tint */
}

.theme-light {
	--background-primary: #eff1f5;
	--background-primary-alt: #e6e9ef;
	--background-secondary: #e6e9ef;
	--background-secondary-alt: #e6e9ef;
	--background-modifier-border: #bcc0cc;
	--background-modifier-hover: rgba(76, 79, 105, 0.1);
	--background-modifier-active-hover: rgba(76, 79, 105, 0.15);

	--text-normal: #4c4f69;
	--text-muted: #6c6f85;
	--text-faint: #9ca0b0;

	--code-background: #dce0e8;
	--code-normal: #4c4f69;

	/* Custom features colors */
	--table-header-bg: #dce0e8;
	--table-row-alt-bg: #f4f6f9;
	--tag-bg: #dce0e8;
	--active-line-bg: rgba(30, 102, 245, 0.05); /* Faint accent tint */
}

/* ==========================================================================
   2. Base Settings
   ========================================================================== */
body {
	--font-text-size: 16px;
	--line-height-normal: 1.6;
	--font-monospace:
		"源ノ角ゴシック", "JetBrains Mono", "Fira Code", monospace;

	/* Keep generic UI rounded, but we will force sharp headers below */
	--radius-s: 4px;
	--radius-m: 8px;
}

/* Cleaner Tabs */
.workspace-tab-header.is-active::before,
.workspace-tab-header.is-active::after {
	display: none;
}

.workspace-tab-header.is-active {
	background-color: var(--background-primary);
	border-top: 3px solid var(--interactive-accent);
	font-weight: 600;
}

/* ==========================================================================
   3. Header Styles (Reading Mode & Live Preview)
   * Sharp corners (No border-radius)
   ========================================================================== */

:is(
	.markdown-preview-view h1,
	.markdown-preview-view h2,
	.markdown-preview-view h3,
	.markdown-preview-view h4,
	.markdown-preview-view h5,
	.markdown-preview-view h6,
	.is-live-preview .HyperMD-header
) {
	border-left-style: solid;
	border-top: none;
	margin-left: 0;
	padding-top: 0.2em;
	padding-bottom: 0.4em;
	margin-top: 1.5em;
	line-height: 1.3;
	transition: all 0.2s ease;

	/* 【変更点】 角を丸くしない（Sharp） */
	border-radius: 0 !important;
}

/* H1 (Title) */
:is(.markdown-preview-view h1, .is-live-preview .HyperMD-header-1) {
	font-size: 1.8em;
	font-weight: 700;
	color: var(--text-normal);
	border-left-width: 8px;
	border-left-color: var(--interactive-accent);
	padding-left: 0.5em;
	border-bottom: 2px solid var(--background-modifier-border);
}

/* H2 (Chapter) */
:is(.markdown-preview-view h2, .is-live-preview .HyperMD-header-2) {
	font-size: 1.6em;
	font-weight: 600;
	color: var(--text-normal);
	border-left-width: 6px;
	border-left-color: var(--interactive-accent);
	margin-top: 2em;
	padding-left: 0.8em;
	border-bottom: 1px solid var(--background-modifier-border);
}

/* H3 (Section) */
:is(.markdown-preview-view h3, .is-live-preview .HyperMD-header-3) {
	font-size: 1.4em;
	font-weight: 600;
	color: var(--text-normal);
	border-left-width: 4px;
	border-left-color: var(--interactive-accent);
	padding-left: 1.1em;
	border-bottom: 1px dotted var(--text-faint);
}

/* H4 - H6 (Subsections) */
:is(.markdown-preview-view h4, .is-live-preview .HyperMD-header-4) {
	font-size: 1.2em;
	font-weight: 600;
	color: var(--text-normal);
	border-left-width: 3px;
	border-left-color: var(--text-faint);
	padding-left: 1.4em;
	border-bottom: 1px dotted var(--text-faint);
}
:is(.markdown-preview-view h5, .is-live-preview .HyperMD-header-5) {
	font-size: 1.1em;
	color: var(--text-muted);
	border-left-width: 2px;
	border-left-color: var(--text-muted);
	padding-left: 1.7em;
}
:is(.markdown-preview-view h6, .is-live-preview .HyperMD-header-6) {
	font-size: 1em;
	color: var(--text-muted);
	border-left-width: 2px;
	border-left-color: var(--text-muted);
	padding-left: 2em;
}

/* Hover Gradient Effect */
:is(
	.markdown-preview-view h1,
	.is-live-preview .HyperMD-header-1,
	.markdown-preview-view h2,
	.is-live-preview .HyperMD-header-2
):hover {
	background: linear-gradient(
		to right,
		var(--background-modifier-hover),
		transparent
	);
}

/* Mobile Responsiveness (Indents) */
@media screen and (max-width: 768px) {
	:is(.markdown-preview-view h1, .is-live-preview .HyperMD-header-1) {
		padding-left: 0.3em;
		border-left-width: 6px;
	}
	:is(.markdown-preview-view h2, .is-live-preview .HyperMD-header-2) {
		padding-left: 0.4em;
		border-left-width: 5px;
	}
	:is(.markdown-preview-view h3, .is-live-preview .HyperMD-header-3) {
		padding-left: 0.5em;
		border-left-width: 4px;
	}
	:is(.markdown-preview-view h4, .is-live-preview .HyperMD-header-4) {
		padding-left: 0.6em;
		border-left-width: 3px;
	}
}

/* ==========================================================================
   4. Source Mode Improvements (可読性向上)
   ========================================================================== */

/* ソースモードの見出し: 装飾はしないが、背景色と太字で区別しやすくする */
.markdown-source-view:not(.is-live-preview) .HyperMD-header {
	background-color: var(
		--background-secondary-alt
	); /* 行全体の背景を少し変える */
	color: var(--interactive-accent); /* 文字色はアクセントカラー */
	font-weight: 600;

	/* リセット */
	border-left: none !important;
	padding-left: 0.5em !important; /* 少しだけ余白を入れると読みやすい */
	margin-left: 0 !important;
	border-bottom: none !important;
	border-radius: 0 !important;

	/* ソースモードでの見出しサイズ微調整 */
	padding-top: 0.5em;
	padding-bottom: 0.5em;
}

/* ==========================================================================
   5. Common Theme Features (工夫機能)
   ========================================================================== */

/* 【変更点】List Bullets (Unified Color)
   箇条書きの点をメインカラーではなく、通常のテキスト色に合わせる */
.list-bullet:after {
	background-color: var(--text-muted) !important;
}

/* Active Line Highlight (カーソルがある行をハイライト) */
.cm-active {
	background-color: var(--active-line-bg);
}

/* Styled Tables (表のデザイン) */
.markdown-preview-view table,
.markdown-source-view table {
	border-collapse: collapse;
	margin-bottom: 1em;
}
.markdown-preview-view th,
.markdown-source-view th {
	background-color: var(--table-header-bg);
	font-weight: 600;
	border: 1px solid var(--background-modifier-border);
}
.markdown-preview-view td,
.markdown-source-view td {
	border: 1px solid var(--background-modifier-border);
}
/* Striped Rows (縞模様) */
.markdown-preview-view tr:nth-child(even),
.markdown-source-view tr:nth-child(even) {
	background-color: var(--table-row-alt-bg);
}

/* Styled Tags (タグのデザイン) */
a.tag {
	background-color: var(--tag-bg);
	border: 1px solid var(--background-modifier-border);
	color: var(--text-normal);
	padding: 0px 6px;
	border-radius: 0px; /* Sharp corners for tags too */
	font-size: 0.9em;
	text-decoration: none !important;
}
a.tag:hover {
	background-color: var(--interactive-accent);
	color: #fff; /* White text on hover */
	border-color: var(--interactive-accent);
}

/* Blockquotes (引用) - Consistent with sharp theme */
.markdown-source-view.mod-cm6 .HyperMD-quote,
.markdown-preview-view blockquote {
	border-left: 3px solid var(--interactive-accent);
	background-color: var(--background-secondary-alt);
	border-radius: 0px; /* Sharp */
	padding: 0.5em 1em;
}

/* Completed Checkboxes (Dimmed) */
.markdown-preview-view .task-list-item.is-checked,
.markdown-source-view .HyperMD-task-line[data-task=":"] {
	color: var(--text-muted);
	text-decoration: line-through;
	opacity: 0.8;
}
